# P1 超越選擇題：答案選項如何膨脹 LLM 金融推理分數
# Beyond Multiple Choice: How Answer Options Inflate LLM Financial Reasoning Scores

> **狀態**：✅ 論文已完成 | **頁數**：11 | **樣本量**：N=100 | **目標期刊**：Finance Research Letters (FRL)
> **論文資料夾**：`drafts/selected/A1_open_ended/`
> **合併自**：A1（開放式數值推理）+ A5（選項偏差量化）

---

## 研究背景與問題

現有 CFA 基準幾乎全部採用 MCQ（多選題）格式，但選項本身會洩漏答案的分布方向——量級提示（選項都在 $900–$1,100 間）、符號提示（全正或有負）讓模型不需要真正計算就能推斷答案。這在測試理論中稱為 **answer-space restriction bias**。

本研究從兩個互補角度切入同一問題：
1. **A5 實驗（Option Bias）**：同一組題目分別以有選項/無選項格式測試，量化選項帶來的分數膨脹
2. **A1 實驗（Three-Tier Evaluation）**：對無選項的開放式作答，設計三層判定機制取代傳統對/錯二分法

核心論點：**MCQ 基準同時「太寬鬆」（選項漏洞灌水）又「太嚴格」（合理的替代分析被判錯）。**

---

## 核心方法

### 方法一覽

**實驗一：Option Bias 量測**

將每道 CFA 題目以兩種格式呈現給同一模型：
- Format A (MCQ)：標準選擇題，含 A/B/C 選項
- Format B (Open-ended)：移除所有選項，要求直接輸出答案

核心指標：`option_bias = accuracy_with_options − accuracy_without_options`

使用 McNemar's test 檢驗配對差異的統計顯著性（每道題在兩種格式下是「對/錯」的 2×2 contingency table）。

**實驗二：Three-Tier Evaluation**

對 Format B 的開放式作答，不再用對/錯二分法，改用三層判定：
- **Level A（Exact Match）**：數值在 tolerance 內且假設合理 → 正確
- **Level B（Directionally Correct）**：符號正確、量級正確，但使用了不同的合理假設 → 單獨統計
- **Level C（Incorrect）**：邏輯錯誤、公式錯誤、單位錯誤 → 真正的錯誤

對 Level C 進行 **structured error attribution**，分析錯誤源頭（formula error, numerical extraction error, calculation error, conceptual error）。

---

### 用一個例子理解

#### 原始 MCQ 題目

> A 2-year bond pays a 6% annual coupon, face value $1,000, yield to maturity 8%. The price is closest to:
> - (A) $964.33
> - (B) $1,000.00
> - (C) $1,036.67

#### 第一步：Option Bias 實驗

**有選項時**：模型看到三個選項都在 $900–$1,100 之間，即使計算能力差，也能排除離譜答案（如 $96.43）。

**去掉選項時**：
> Calculate the price of this bond.

模型必須從零算出數值，沒有量級提示可以依靠。

如果模型有選項時答對、去掉選項後答錯 → 這道題就貢獻了 1 個 option bias。100 題中有 21 題出現這種情況，option bias = +12.0 pp。

#### 第二步：Three-Tier 判定

假設 4 個模型在去掉選項後各回答：

| 模型 | 回答 | 判定 | 理由 |
|------|------|------|------|
| GPT-4o | $964.33 | **Level A** ✅ | 精確匹配 |
| Qwen3:32b | $964.54 | **Level B** ⚠️ | 用了 semi-annual compounding，合理假設不同 |
| Llama3.1:8b | $96.43 | **Level C** ❌ | 小數點錯位 → numerical extraction error |
| DeepSeek-R1 | $1,036.67 | **Level C** ❌ | coupon/yield 搞反 → formula selection error |

傳統二元評分下，Qwen 和 Llama 都是「錯」——但一個只差 $0.21（假設不同），一個差了 $868（能力缺陷）。三層判定能區分這兩種情況。

---

## 實驗設計（實際執行）

| 項目 | 內容 |
|------|------|
| 測試集 | FinEval-CFA-Easy，100 題 |
| 模型 | GPT-4o-mini |
| Format A | 標準 MCQ（含選項） |
| Format B | Open-ended（無選項） |
| 統計檢定 | McNemar's test (paired) |
| 評分 | Level A/B/C + error attribution (GPT-4o-mini as judge) |

---

## 核心結果

### Option Bias (A5)

| 指標 | 數值 |
|------|------|
| Accuracy WITH options | 85.0% |
| Accuracy WITHOUT options | 73.0% |
| **Option Bias** | **+12.0 pp** |
| Biased Questions | 21/100 (21%) |
| McNemar's test | b=21, c=9, chi-squared=4.033, **p=0.045** (顯著) |

→ 選項幫了 12 個百分點的忙，五分之一的題目存在 bias。

### Three-Tier Evaluation (A1)

| Level | 數量 | 百分比 |
|-------|------|--------|
| A (Exact Match) | 34 | 34.0% |
| B (Directionally Correct) | 28 | 28.0% |
| C (Incorrect) | 38 | 38.0% |
| **Strict Accuracy** | -- | **34.0%** |
| **Lenient Accuracy** | -- | **62.0%** |

→ 28% 被二元評分判為「錯」的答案其實推理方向正確，只是用了不同的金融假設。嚴格與寬鬆之間差了 28 pp。

### Error Attribution (Level C, N=38)

| 錯誤類型 | 數量 | 百分比 |
|----------|------|--------|
| Conceptual Error | 21 | 55.3% |
| 其他 | 17 | 44.7% |

---

## 一句話總結

> **把選擇題變填空題，然後不只看對錯，還看「錯在哪裡」和「是不是真的錯」。MCQ 灌水 12 pp，而 28% 的「錯誤」其實只是假設不同。**

---

## 附錄

### 合併邏輯

原始提案 A1 和 A5 是同一研究問題的兩面：
- A5 問「選項幫了多少忙？」→ option bias = +12 pp
- A1 問「去掉選項後，怎麼公平評分？」→ three-tier evaluation

兩者共享同一批 100 題測試數據，自然合併為一篇。

### 實驗數據路徑

| 資料 | 路徑 |
|------|------|
| A1 結果 (N=100) | `experiments/A1_open_ended/results/run_20260206_112613/results.json` |
| A5 結果 (N=100) | `experiments/A5_option_bias/results/run_20260206_112714/results.json` |

### 論文檔案結構

```
drafts/selected/A1_open_ended/
├── main.tex                    # 完整論文 (11 pages)
├── main.pdf                    # 編譯 PDF
├── figures/
│   ├── fig1_option_bias.pdf
│   └── fig2_three_tier_evaluation.pdf
├── tables/
└── submission/
    └── cover_letter.tex
```
