# P1 超越選擇題：答案選項如何膨脹 LLM 金融推理分數
# Beyond Multiple Choice: How Answer Options Inflate LLM Financial Reasoning Scores

> **狀態**：✅ 論文已完成 | **字數**：3,719 words | **樣本量**：N=1,032 | **目標期刊**：Finance Research Letters (FRL)
> **論文資料夾**：`drafts/selected/A1_open_ended/`
> **合併自**：A1（開放式數值推理）+ A5（選項偏差量化）

---

## 研究背景與問題

現有 CFA 基準幾乎全部採用 MCQ（多選題）格式，但選項本身會洩漏答案的分布方向——量級提示（選項都在 $900–$1,100 間）、符號提示（全正或有負）讓模型不需要真正計算就能推斷答案。這在測試理論中稱為 **answer-space restriction bias**。

本研究從兩個互補角度切入同一問題：
1. **A5 實驗（Option Bias）**：同一組題目分別以有選項/無選項格式測試，量化選項帶來的分數膨脹
2. **A1 實驗（Three-Tier Evaluation）**：對無選項的開放式作答，設計三層判定機制取代傳統對/錯二分法

核心論點：**MCQ 基準同時「太寬鬆」（選項漏洞灌水）又「太嚴格」（合理的替代分析被判錯）。**

---

## 核心方法

### 方法一覽

**實驗一：Option Bias 量測**

將每道 CFA 題目以兩種格式呈現給同一模型：
- Format A (MCQ)：標準選擇題，含 A/B/C 選項
- Format B (Open-ended)：移除所有選項，要求直接輸出答案

核心指標：`option_bias = accuracy_with_options − accuracy_without_options`

使用 McNemar's test 檢驗配對差異的統計顯著性（每道題在兩種格式下是「對/錯」的 2×2 contingency table）。

**實驗二：Three-Tier Evaluation**

對 Format B 的開放式作答，不再用對/錯二分法，改用三層判定：
- **Level A（Exact Match）**：數值在 tolerance 內且假設合理 → 正確
- **Level B（Directionally Correct）**：符號正確、量級正確，但使用了不同的合理假設 → 單獨統計
- **Level C（Incorrect）**：邏輯錯誤、公式錯誤、單位錯誤 → 真正的錯誤

對 Level C 進行 **structured error attribution**，分析錯誤源頭（formula error, numerical extraction error, calculation error, conceptual error）。

---

### 用一個例子理解

#### 原始 MCQ 題目

> A 2-year bond pays a 6% annual coupon, face value $1,000, yield to maturity 8%. The price is closest to:
> - (A) $964.33
> - (B) $1,000.00
> - (C) $1,036.67

#### 第一步：Option Bias 實驗

**有選項時**：模型看到三個選項都在 $900–$1,100 之間，即使計算能力差，也能排除離譜答案（如 $96.43）。

**去掉選項時**：
> Calculate the price of this bond.

模型必須從零算出數值，沒有量級提示可以依靠。

如果模型有選項時答對、去掉選項後答錯 → 這道題就貢獻了 1 個 option bias。

#### 第二步：Three-Tier 判定

假設 4 個模型在去掉選項後各回答：

| 模型 | 回答 | 判定 | 理由 |
|------|------|------|------|
| GPT-4o | $964.33 | **Level A** | 精確匹配 |
| Qwen3:32b | $964.54 | **Level B** | 用了 semi-annual compounding，合理假設不同 |
| Llama3.1:8b | $96.43 | **Level C** | 小數點錯位 → numerical extraction error |
| DeepSeek-R1 | $1,036.67 | **Level C** | coupon/yield 搞反 → formula selection error |

傳統二元評分下，Qwen 和 Llama 都是「錯」——但一個只差 $0.21（假設不同），一個差了 $868（能力缺陷）。三層判定能區分這兩種情況。

---

## 實驗設計（實際執行）

| 項目 | 內容 |
|------|------|
| 測試集 | FinEval-CFA-Easy，1,032 題 |
| 模型 | GPT-4o-mini, GPT-5-mini |
| Format A | 標準 MCQ（含選項） |
| Format B | Open-ended（無選項） |
| 統計檢定 | McNemar's test (paired, Yates' correction) |
| 評分 | Level A/B/C + error attribution (GPT-4o-mini as judge) |

---

## 核心結果

### Option Bias (A5)

#### GPT-4o-mini

| 指標 | 數值 |
|------|------|
| Accuracy WITH options | 82.6% |
| Accuracy WITHOUT options | 80.6% |
| **Option Bias** | **+1.9 pp** |
| McNemar's test | **p=0.251** (不顯著) |

> GPT-4o-mini 的選項偏差僅 1.9 pp 且統計上不顯著——模型已能在無選項下維持接近的準確率。

#### GPT-5-mini

| 指標 | 數值 |
|------|------|
| Accuracy WITH options | 92.8% |
| Accuracy WITHOUT options | 83.2% |
| **Option Bias** | **+9.6 pp** |
| McNemar's test | **p<0.001*** |

> GPT-5-mini 在有選項時準確率飆升至 92.8%，但去掉選項後降到 83.2%，偏差高達 9.6 pp 且高度顯著。

#### 跨模型關鍵發現

**Option bias 是模型依賴的（model-dependent）。** 更強的模型（GPT-5-mini）反而展現更大的選項偏差——它更擅長利用選項中的線索，但這也意味著 MCQ 格式更嚴重地高估了它的真實推理能力。

### Three-Tier Evaluation (A1)

#### GPT-4o-mini

| Level | 百分比 |
|-------|--------|
| A (Exact Match) | 24.5% |
| B (Directionally Correct) | 21.5% |
| C (Incorrect) | 54.0% |
| **Strict Accuracy** | **24.5%** |
| **Lenient Accuracy** | **46.0%** |

> 21.5% 被二元評分判為「錯」的答案其實推理方向正確，只是用了不同的金融假設。嚴格與寬鬆之間差了 21.5 pp。

#### GPT-5-mini

| Level | 百分比 |
|-------|--------|
| A (Exact Match) | 41.8% |
| B (Directionally Correct) | 22.3% |
| C (Incorrect) | 35.9% |

> GPT-5-mini 的精確匹配率（41.8%）大幅領先 GPT-4o-mini（24.5%），但仍有超過三分之一的題目回答完全錯誤。

---

## 一句話總結

> **Option bias 是模型依賴的：GPT-4o-mini 僅 +1.9 pp（不顯著），但 GPT-5-mini 高達 +9.6 pp（p<0.001）。MCQ 格式對越強的模型灌水越多。同時，21–22% 的「錯誤」答案其實推理方向正確，三層評估能揭示被二元評分掩蓋的真實能力。**

---

## 附錄

### 合併邏輯

原始提案 A1 和 A5 是同一研究問題的兩面：
- A5 問「選項幫了多少忙？」→ option bias（模型依賴：+1.9 pp vs +9.6 pp）
- A1 問「去掉選項後，怎麼公平評分？」→ three-tier evaluation

兩者共享同一批 1,032 題測試數據，自然合併為一篇。

### 實驗數據路徑

| 資料 | 路徑 |
|------|------|
| A5 結果 GPT-4o-mini (N=1,032) | `experiments/A5_option_bias/results/run_20260206_171904/results.json` |
| A5 結果 GPT-5-mini (N=1,032) | `experiments/A5_option_bias/results/run_20260207_174114/results.json` |
| A1 結果 GPT-4o-mini (N=1,032) | `experiments/A1_open_ended/results/run_20260206_173445/results.json` |
| A1 結果 GPT-5-mini (N=1,032) | `experiments/A1_open_ended/results/run_20260207_174118/results.json` |

### 論文檔案結構

```
drafts/selected/A1_open_ended/
├── main.tex                    # 完整論文 (3,719 words)
├── main.pdf                    # 編譯 PDF
├── figures/
│   ├── fig1_option_bias.pdf
│   ├── fig2_three_tier_evaluation.pdf
│   ├── fig3_cross_model_option_bias.pdf
│   └── fig4_cross_model_three_tier.pdf
├── tables/
└── submission/
    └── cover_letter.tex
```
